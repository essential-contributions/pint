<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The match Construct - The Book of Pint</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../the-book-of-pint.html">The Book of Pint</a></li><li class="chapter-item expanded "><a href="../../getting_started/index.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../getting_started/installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../../getting_started/quickstart.html"><strong aria-hidden="true">1.2.</strong> Quickstart Guide</a></li></ol></li><li class="chapter-item expanded "><a href="../../examples/index.html"><strong aria-hidden="true">2.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../examples/counter.html"><strong aria-hidden="true">2.1.</strong> Counter</a></li><li class="chapter-item expanded "><a href="../../examples/subcurrency.html"><strong aria-hidden="true">2.2.</strong> Subcurrency</a></li></ol></li><li class="chapter-item expanded "><a href="../../basics/index.html"><strong aria-hidden="true">3.</strong> Common Programming Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basics/variables.html"><strong aria-hidden="true">3.1.</strong> Decision Variables</a></li><li class="chapter-item expanded "><a href="../../basics/data_types.html"><strong aria-hidden="true">3.2.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="../../basics/comments.html"><strong aria-hidden="true">3.3.</strong> Comments</a></li><li class="chapter-item expanded "><a href="../../basics/conditionals.html"><strong aria-hidden="true">3.4.</strong> Conditionals</a></li><li class="chapter-item expanded "><a href="../../basics/custom_types.html"><strong aria-hidden="true">3.5.</strong> Custom Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basics/custom_types/type_aliases.html"><strong aria-hidden="true">3.5.1.</strong> Type Aliases</a></li><li class="chapter-item expanded "><a href="../../basics/custom_types/unions.html"><strong aria-hidden="true">3.5.2.</strong> Unions</a></li><li class="chapter-item expanded "><a href="../../basics/custom_types/match.html" class="active"><strong aria-hidden="true">3.5.3.</strong> The match Construct</a></li></ol></li><li class="chapter-item expanded "><a href="../../basics/constraints.html"><strong aria-hidden="true">3.6.</strong> Constraints</a></li><li class="chapter-item expanded "><a href="../../basics/constants.html"><strong aria-hidden="true">3.7.</strong> Constants</a></li></ol></li><li class="chapter-item expanded "><a href="../../smart_contracts/index.html"><strong aria-hidden="true">4.</strong> Pint Smart Contracts</a></li><li class="chapter-item expanded "><a href="../../storage/index.html"><strong aria-hidden="true">5.</strong> Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/static.html"><strong aria-hidden="true">5.1.</strong> Statically-Sized Storage Types</a></li><li class="chapter-item expanded "><a href="../../storage/dynamic.html"><strong aria-hidden="true">5.2.</strong> Dynamically-Sized Storage Types</a></li><li class="chapter-item expanded "><a href="../../storage/external.html"><strong aria-hidden="true">5.3.</strong> External Storage Access</a></li></ol></li><li class="chapter-item expanded "><a href="../../projects/index.html"><strong aria-hidden="true">6.</strong> Managing Growing Projects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../projects/packages.html"><strong aria-hidden="true">6.1.</strong> Pint Projects</a></li><li class="chapter-item expanded "><a href="../../projects/modules.html"><strong aria-hidden="true">6.2.</strong> Defining Modules</a></li><li class="chapter-item expanded "><a href="../../projects/paths.html"><strong aria-hidden="true">6.3.</strong> Paths for Referring to an item in a Module Tree</a></li><li class="chapter-item expanded "><a href="../../projects/use.html"><strong aria-hidden="true">6.4.</strong> Bringing Paths into Scope with the use Keyword</a></li></ol></li><li class="chapter-item expanded "><a href="../../advanced/index.html"><strong aria-hidden="true">7.</strong> Advanced Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../advanced/pub_vars.html"><strong aria-hidden="true">7.1.</strong> Public Decision Variables</a></li><li class="chapter-item expanded "><a href="../../advanced/macros.html"><strong aria-hidden="true">7.2.</strong> Macros</a></li></ol></li><li class="chapter-item expanded "><a href="../../pint-reference/index.html"><strong aria-hidden="true">8.</strong> Pint Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../pint-reference/cli.html"><strong aria-hidden="true">8.1.</strong> Commands</a></li><li class="chapter-item expanded "><a href="../../pint-reference/manifest.html"><strong aria-hidden="true">8.2.</strong> Manifest</a></li></ol></li><li class="chapter-item expanded "><a href="../../appendix/index.html"><strong aria-hidden="true">9.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../appendix/keywords.html"><strong aria-hidden="true">9.1.</strong> A - Keywords</a></li><li class="chapter-item expanded "><a href="../../appendix/intrinsics.html"><strong aria-hidden="true">9.2.</strong> B - Compiler Intrinsics</a></li><li class="chapter-item expanded "><a href="../../appendix/abi.html"><strong aria-hidden="true">9.3.</strong> C - Application Binary Interface (ABI) Spec</a></li><li class="chapter-item expanded "><a href="../../appendix/known_issues.html"><strong aria-hidden="true">9.4.</strong> A - Known Issues and Missing Features</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Book of Pint</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/essential-contributions/pint" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h2 id="the-match-construct"><a class="header" href="#the-match-construct">The <code>match</code> Construct</a></h2>
<p>Pint has the powerful construct <code>match</code> that allows you to inspect a value that has a union type and
conditionally execute some code based on which union variant that union value matches. The power of
<code>match</code> comes from the introduction of the union variant datum into a specific scope, and the fact
that the compiler confirms that all possible variants are handled.</p>
<p>Pint has both <code>match</code> <strong>expressions</strong> and <code>match</code> <strong>statements</strong>, the distinction between which is
illustrated below.</p>
<h3 id="match-as-an-expression"><a class="header" href="#match-as-an-expression"><code>match</code> as an Expression</a></h3>
<p>Consider the following example which takes an unknown US coin and determines which coin it is and
returns its value in cents:</p>
<pre><code class="language-pint">union Coin = Penny | Nickel | Dime | Quarter;

predicate CoinConversion1 {
    var coin: Coin;

    var coin_in_cents = match coin {
        Coin::Penny =&gt; 1,
        Coin::Nickel =&gt; 5,
        Coin::Dime =&gt; 10,
        Coin::Quarter =&gt; 25,
    };
}
</code></pre>
<p>Let’s break down the <code>match</code> expression above. First we list the <code>match</code> keyword followed by an
expression, which in this case is the value <code>coin</code>. This seems very similar to a conditional
expression used with <code>cond</code>, but there’s a big difference: with <code>cond</code>, the condition needs to
evaluate to a Boolean value, but here it has to be a union variant of <code>Coin</code> because this is the
type of the value <code>coin</code>.</p>
<p>Next are the <code>match</code> arms. An arm has two parts: a pattern and some code. The first arm here has a
pattern that is the value <code>Coin::Penny</code> and then the <code>=&gt;</code> operator that separates the pattern and
the code to run. The code in this case is just the value <code>1</code>. Each arm is separated from the next
with a comma.</p>
<p>In this particular example, the code associated with each arm is an expression, and the resultant
value of the expression in the matching arm is the value that gets returned for the entire <code>match</code>
expression.</p>
<p>It is also possible to include <code>constraints</code> in the match arm code, but you must use curly brackets.
For example, the following code requires the Boolean variable <code>is_lucky_penny</code> to be <code>true</code> if the
value <code>coin</code> is a <code>Coin::Penny</code>.</p>
<pre><code class="language-pint">predicate CoinConversion2 {
    var coin: Coin;
    var is_lucky_penny: bool;

    var coin_in_cents = match coin {
        Coin::Penny =&gt; {
            constraint is_lucky_penny;
            1
        },
        Coin::Nickel =&gt; 5,
        Coin::Dime =&gt; 10,
        Coin::Quarter =&gt; 25,
    };
}
</code></pre>
<h4 id="patterns-that-bind-to-values"><a class="header" href="#patterns-that-bind-to-values">Patterns that Bind to Values</a></h4>
<p>Another useful feature of match arms is that they can bind to the value that match the pattern. This
is how we can extract values out of union variants.</p>
<p>As an example, let's change our union variants to hold data inside them. Namely, we want each
variant to hold an <code>int</code> that represents the number of coins available:</p>
<pre><code class="language-pint">union Coins = Penny(int) | Nickel(int) | Dime(int) | Quarter(int);
</code></pre>
<p>Now, given a value <code>coins</code> of type <code>Coins</code>, we can compute the total number of cents that <code>coins</code> is
equivalent to as follows:</p>
<pre><code class="language-pint">predicate CoinConversion3 {
    var coins: Coins;

    var coins_in_cents = match coins {
        Coins::Penny(n) =&gt; n,
        Coins::Nickel(n) =&gt; n * 5,
        Coins::Dime(n) =&gt; n * 10,
        Coins::Quarter(n) =&gt; n * 25,
    };
}
</code></pre>
<p>In the <code>match</code> expression above, we add a variable called <code>n</code> for each of the patterns. In each
pattern, <code>n</code> will bind to the value that the union variant holds. For example, if <code>coins</code> is equal
to <code>Coin::Nickel(42)</code>, then we expect <code>coins_in_cents</code> to be equal to <code>42 * 5 == 210</code>.</p>
<p>Note that <code>match</code> expressions can be nested. Here's an example that has nested unions and nested
<code>match</code> expressions to compute a <code>prize</code> given a coin and the face it landed on in a head-or-tails
game.</p>
<pre><code class="language-pint">union Face = Head | Tail; 
union CoinFace =  Penny(Face) 
                | Nickel(Face) 
                | Dime (Face) 
                | Quarter(Face);

predicate CoinGame1 {
    var coin: CoinFace;

    var prize = match coin {
        CoinFace::Penny(f) =&gt; match f {
            Face::Head =&gt; 100,
            Face::Tail =&gt; 200,
        },
        CoinFace::Nickel(f) =&gt; 5 * match f {
            Face::Head =&gt; 10,
            Face::Tail =&gt; 20,
        },
        CoinFace::Dime(f) =&gt; 10 * match f {
            Face::Head =&gt; 5,
            Face::Tail =&gt; 10,
        },
        CoinFace::Quarter(f) =&gt; 25 * match f {
            Face::Head =&gt; 1,
            Face::Tail =&gt; 2,
        },
    };
}
</code></pre>
<h3 id="match-as-a-statement"><a class="header" href="#match-as-a-statement"><code>match</code> as a Statement</a></h3>
<p>In some cases, you may not need a <code>match</code> to return a value. Instead, you may simply want
to enforce conditional constraints based on which pattern matches the given value. Below is a
rewrite of the previous example that uses <code>match</code> statements. The code exhibits the exact same
behavior as before but written different to showcase <code>match</code> statements.</p>
<pre><code class="language-pint">predicate CoinGame2 {
    var coin: CoinFace;

    var prize: int;

    match coin {
        CoinFace::Penny(f) =&gt; {
            match f {
                Face::Head =&gt; {
                    constraint prize == 100;
                }
                Face::Tail =&gt; {
                    constraint prize == 200;
                }
            }
        }
        CoinFace::Nickel(f) =&gt; {
            if f == Face::Head {
                constraint prize == 5 * 10;
            } else {
                constraint prize == 5 * 20;
            }
        }
        CoinFace::Dime(f) =&gt; {
            constraint f == Face::Head ? 10 * 5 : 10 * 10;
        }
        CoinFace::Quarter(f) =&gt; {
            constraint prize == 25 * match f {
                Face::Head =&gt; 1,
                Face::Tail =&gt; 2,
            };
        }
    }
}
</code></pre>
<p>Here, the top level <code>match</code> is a statement, not an expression; it does not return any value.
Instead, it declares some constraints, each based on one or more conditions. .</p>
<ul>
<li>If <code>coin</code> matches <code>CoinFace::Penny(f)</code>, then we add another <code>match</code> statement that includes
different constraints based on what pattern <code>f</code> matches.</li>
<li>If <code>coin</code> matches <code>CoinFace::Nickel(f)</code>, then we add an <code>if</code> statement that also includes
different constraints based on whether <code>f</code> is equal to <code>Face::Head</code> or not.</li>
<li>If <code>coin</code> matches <code>CoinFace::Dime(f)</code>, then we add a single constraint that uses a select
expression to compute the prize.</li>
<li>If <code>coin</code> matches <code>CoinFace::Quarter(f)</code>, then we add a single constraint that relies on a <code>match</code>
expression.</li>
</ul>
<p>As shown, nested <code>if</code> statements and <code>match</code> statements are allowed within <code>match</code> statement arms,
as are <code>constraint</code> statements.</p>
<h3 id="matches-are-exhaustive"><a class="header" href="#matches-are-exhaustive">Matches are Exhaustive</a></h3>
<p>There’s one other aspect of <code>match</code> we need to discuss: the arms’ patterns must cover all
possibilities. Consider the following version of variables <code>coins</code> and <code>coins_in_cents</code> previously
declared:</p>
<pre><code class="language-pint">var coins: Coins;
var coins_in_cents = match coins {
    Coins::Penny(n) =&gt; n,
    Coins::Nickel(n) =&gt; n * 5,
    Coins::Quarter(n) =&gt; n * 25,
};
</code></pre>
<p>We didn't handle the <code>Coins::Dime(n)</code> case, so this code will cause a bug. Luckily, it's a bug the
Pint compiler knows how to catch. If we try to compile this code, we'll get this error:</p>
<pre><code class="language-console">Error: not all match variants are covered
    ╭─[ch_3_5_3.pnt:42:26]
    │
 42 │ ╭─▶     var coins_in_cents = match coins {
    ┆ ┆
 46 │ ├─▶     };
    │ │
    │ ╰──────────── not all variants for union `::Coins` are covered by match
    │
    │     Help: branches and/or bindings are required for variant `Coins::Dime`
────╯
Error: could not compile `ch_3_5_3.pnt` due to previous error
</code></pre>
<p>The Pint compiler knows that we didn't cover every possible case, and even knows which pattern we
forgot. Matches in Pint are <em>exhaustive</em>: we must exhaust every last possibility in order for the
code to be valid. This is true for both <code>match</code> expressions and <code>match</code> statements!</p>
<h3 id="catch-all-patterns"><a class="header" href="#catch-all-patterns">Catch-all Patterns</a></h3>
<p>In the case where not every variant is significant, <code>match</code> expressions and statements may employ an
<code>else</code> arm. It must be declared last and will obviously have no value bound, and is useful to
evaluate to a default value for <code>match</code> expressions, or to contain default declarations (or none)
for <code>match</code> statements.</p>
<p>To get the above example to compile with a default value of zero, implying any other coins actually
have no value, an <code>else</code> may be used as follows:</p>
<pre><code class="language-pint">    var coins: Coins;
    var coins_in_cents = match coins {
        Coins::Penny(n) =&gt; n,
        Coins::Nickel(n) =&gt; n * 5,
        Coins::Quarter(n) =&gt; n * 25,
        else =&gt; 0,
    };
</code></pre>
<p>The code compiles, even though we haven't listed all the possible values a <code>Coins</code> can have, because
the last pattern will match all values not specifically listed. This catch-all pattern meets the
requirement that <code>match</code> must be exhaustive.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../basics/custom_types/unions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../basics/constraints.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../basics/custom_types/unions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../basics/constraints.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../theme/pint.js"></script>
        <script src="../../theme/bnf.js"></script>


    </div>
    </body>
</html>
