use lib::@foo;
use ::lib::@equal;
use lib::{@a, @b, @sum};

intent Foo {
   ::lib::@foo(3);
   constraint @equal(4; 4);
}

intent Bar {
   @foo(4);
   constraint lib::@equal([ 1.0, 2.0 ]; [ 1.0, 2.0 ]);
}

// This does not work yet. See ##504
//intent Baz {
//    let v: int;
//    constraint @a(v);
//    constraint @b(v);
//    constraint @a(v);
//    constraint @b(v);
//}

// This does not work yet. See ##504
//intent Sum {
//    let a: int = 4;
//    let b: int = @sum(1; 2; 3; a);
//}

// intermediate <<<
// intent ::Bar {
//     var ::anon@0::a: int;
//     constraint ([1e0, 2e0] == [1e0, 2e0]);
//     constraint (::anon@0::a == 4);
// }
// 
// intent ::Foo {
//     var ::anon@1::a: int;
//     constraint (4 == 4);
//     constraint (::anon@1::a == 3);
// }
// >>>

// flattened <<<
// intent ::Bar {
//     var ::anon@0::a: int;
//     constraint ((1e0 == 1e0) && (2e0 == 2e0));
//     constraint (::anon@0::a == 4);
// }
// 
// intent ::Foo {
//     var ::anon@1::a: int;
//     constraint (4 == 4);
//     constraint (::anon@1::a == 3);
// }
// >>>
